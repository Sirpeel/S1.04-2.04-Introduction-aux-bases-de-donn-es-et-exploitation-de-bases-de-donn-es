--Exercice 3

--Q1: Combien de colonnes dans import?


--Q2:Combien de lignes dans import?
Select Count(*)
From import;

--Q3:Combien de codes NOC dans noc?
Select  Count(DISTINCT noc)
From import;


--Q4:Combien d'athletes différents sont référencés dans ce fichier?
Select Count(Distinct name)
From import;

--Q5:Combien y-a-t-il de médailles d'or dans ce fichier?
Select Count(medal)
From import
Where medal='Gold';

--Q6:Retrouvez Carl Lewis; Combien de Lignes se réfèrent à Carl Lewis?
Select Count(*)
From import
Where name LIKE 'Carl Lewis%';

--Exercice 5

--Q1:Liste des pays classés par participation aux épreuves.
SELECT regions.region, COUNT(resultat.gno) AS nbParticipation
FROM resultat JOIN team USING(tno) JOIN regions USING(NOC)
GROUP BY regions.region
ORDER BY COUNT(resultat.gno) DESC,regions.region;


--Q2:Liste des pays classés par nombre de médailles d'or.

Select regions.region, Count(resultat.medal) As nbMédailleDOr
From resultat Join team Using(tno)
Join regions Using(NOC)
Where resultat.medal='Gold'
Group By regions.region
Order By Count(resultat.medal) DESC, regions.region;

--Q3:Liste des pays classés par nombre de médailles total.

Select regions.region, Count(resultat.medal) As nbMédaille
From resultat Join team using(tno)
Join regions Using(NOC)
Group By regions.region
Order By Count(resultat.medal) DESC, regions.region;

--Q4:Liste des sportifs ayant le plus de médailles d'or,avec le nombre.
SELECT ano, name, COUNT(*)
FROM resultat JOIN Athlete USING(ano)
WHERE medal = 'Gold'
GROUP BY ano,name
ORDER BY COUNT(*) DESC;

--Q5:Nombre de médailles cumulées par pays pour les jeux d'Albertville,par ordre décroissant.
select region, COUNT(*) as medals
from resultat
inner join team using(tno)
inner join regions using(noc)
inner join jo using(gno)
where medal is not null
and jo.city = 'Albertville'
group by region
order by medals desc;

--Q6:Combien de sportifs ont fait les jeux olympiques sous 2 drapeaux différents, le premier étant la France? Selon vous quel est le plus connu/célèbre/titré?
select count(*)
from resultat as r1
inner join resultat as r2 using(ano)
inner join jo as j1 on (j1.gno = r1.gno)
inner join jo as j2 on (j2.gno = r2.gno)
where r1.tno <> r2.tno
and r1.tno not in (select tno from team where noc = 'FRA')
and r2.tno in (select tno from team where noc = 'FRA')
and j2.year > j1.year;

--Q7: Combien de sportifs ont fait les jeux olympiques sous 2 drapeaux différents, le premier étant la France ? (1 valeur)Selon vous quel est le plus connu/célèbre/titré/... ?
select count(*)
from resultat as r1
inner join resultat as r2 using(ano)
inner join jo as j1 on (j1.gno = r1.gno)
inner join jo as j2 on (j2.gno = r2.gno)
where r1.tno <> r2.tno
and r1.tno not in (select tno from team where noc = 'FRA')
and r2.tno in (select tno from team where noc = 'FRA')
and j2.year < j1.year;

--Q8: Distribution des âges des médaillés d’or (2 cols)
select age, count(*)
from resultat
where medal = 'Gold'
group by age;


--Q9: Distribution des disciplines donnant des médailles aux plus de 50 ans par ordre décroissant (2 cols)
select e.sport, count(*)
from resultat as r
inner join events as e using(eno)
where r.age >= 50
and r.medal is not null
group by e.sport;

--Q10: Nombre d’épreuves par type de jeux (hivers,été), par année croissante (3 cols)
select j.season, j.year, count(DISTINCT eno)
from resultat as r
inner join jo as j using(gno)
group by j.season, j.year
order by j.year asc;


--Q11: Nombre de médailles féminines aux jeux d’été par année croissante (2 cols)
select j.year, count(*)
from resultat as r
inner join jo as j using(gno)
where r.medal is not null
and r.sex = 'F'
group by j.year
order by j.year asc;

--Exercice 6
--Nous avons choisi la Colombie et le weightlifting


--Q1: Noms des colombiens ayant gagné une médaille d'or faisant du weightlifting avec leur poid.
Select name,height
From resultat As re Join team As t
Using(tno)
Join events as e
Using(eno)
Where NOC='COL' AND medal='Gold' AND sport='Weightlifting'
Group By name,height
Order By name DESC;

--Q2: Noms  de colombiennes  ayant participé à des épreuves de weightlifting.

Select Distinct  name
From resultat join team
Using(tno)
Join events
Using(eno)
Where  NOC='COL' AND sex='F' AND sport='Weightlifting'
Order By name DESC;


--Q3: Noms , jeux ou les colombiens ont remporté ou non des médailles dans les épreuves de weightlifting apres 2012.
Select Distinct  name,games,medal
From resultat Join team
Using(tno)
Join jo
Using(gno)
Join events
Using(eno)
Where NOC='COL' AND sport='Weightlifting' AND year>=2012 AND sex='M'
Group By name,games,medal
Order By name DESC;

--Q4 :Le nom des épreuves de weightlifting recensées depuis 2010 où ont participé des colombiens.
select e.ename
from resultat as r
inner join jo as j using(gno)
inner join events as e using(eno)
inner join team as t using(tno)
where j.year >= 2010
and t.noc = 'COL';














